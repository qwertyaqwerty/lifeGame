!function(){"use strict";var a,b,c,d,e,f,g,h,i,j=5,k=Math.floor(($(window).width()-10)/j),l=Math.floor(($(window).height()-45)/j),m="#ddd",n=2,o="#000",p="#fff",q="#999",r=3,s=2,t=0,u=100,v=.15,w=!1,x=function(b,d){if(c[b][d])return!1;var e=0;if(0===t)for(var f=1;2>=f;f++)e+=a[(b+f)%l][d]+a[(b-f+l)%l][d]+a[b][(d+f)%k]+a[b][(d-f+k)%k];else if(1===t)for(var g=-1;1>=g;g++)for(var h=-1;1>=h;h++)(0!==g||0!==h)&&(e+=a[(b+g+l)%l][(d+h+k)%k]);return e===r?!0:e!=s?!1:a[b][d]},y=function(){for(var c=0;l>c;c++)for(var d=0;k>d;d++)b[c][d]=x(c,d);var e=!1;for(c=0;l>c;c++)for(d=0;k>d;d++)e=a[c][d],a[c][d]=b[c][d],b[c][d]=e},z=function(){for(var d=0;l>d;d++)for(var e=0;k>e;e++)c[d][e]||(a[d][e]=Boolean(Math.random()<v),b[d][e]=!a[d][e]);B(),D()},A=function(a,b,c){e.fillStyle=c,e.beginPath(),e.rect(b*j+n/2,a*j+n/2,j-n,j-n),e.fill()},B=function(){e.save(),e.fillStyle=o;for(var c=0;l>c;c++)for(var d=0;k>d;d++)e.beginPath(),e.rect(d*j+n/2,c*j+n/2,j-n,j-n),a[c][d]!==b[c][d]&&a[c][d]&&e.fill();e.fillStyle=p;for(var c=0;l>c;c++)for(var d=0;k>d;d++)e.beginPath(),e.rect(d*j+n/2,c*j+n/2,j-n,j-n),a[c][d]!==b[c][d]&&(a[c][d]||e.fill());e.restore()},C=function(){e.save(),e.beginPath(),e.lineWidth=n,e.strokeStyle=m;for(var a=0;k>=a;a++)e.moveTo(a*j,0),e.lineTo(a*j,l*j);for(a=0;l>=a;a++)e.moveTo(0,a*j),e.lineTo(k*j,a*j);e.stroke(),e.restore()},D=function(){w=!0,f.css("background-position","53% -2%"),i=setInterval(function(){y(),B()},u)},E=function(){w&&clearInterval(i),w=!1,f.css("background-position","103% -2%")},F=function(){E(),k=Math.floor(($("#show").width()+10)/j),l=Math.floor(($(window).height()-45)/j),d.width=k*j,d.height=l*j,a=new Array(l),b=new Array(l),c=new Array(l);for(var f=0;l>f;f++){a[f]=new Array(k),b[f]=new Array(k),c[f]=new Array(k);for(var g=0;k>g;g++)a[f][g]=!1,b[f][g]=!1,c[f][g]=!1}e.clearRect(0,0,d.width,d.height),C()},G=function(){2===arguments.length?k=l=arguments[1]:arguments.length>=3&&(k=arguments[1],l=arguments[2],j=arguments[3]);arguments[0],document.getElementById(arguments[0]);d=document.getElementById("show-canvas"),e=d.getContext("2d"),f=$("#play-control"),g=$("#apply-changes"),h=$("#random-map"),F(),f.click(function(a){w?E():D()}),g.click(function(a){j=Number($("#grid-size").val()),u=Math.floor(1e3/Number($("#frame-rate").val())),v=Number($("#init-pos").val()),t=Number($("input[name='rule-set']:checked").val()),F()}),h.click(function(a){E(),z()}),$(window).keypress(function(c){if(13==c.which)w?E():D();else if(32==c.which&&!w){for(var d=0;l>d;d++)for(var e=0;k>e;e++)a[d][e]=!1,b[d][e]=!0;for(B(),d=0;l>d;d++)for(e=0;k>e;e++)b[d][e]=!1}}),document.oncontextmenu=function(){return!1},$(d).mousedown(function(d){if(console.log(Math.floor(d.offsetX/j)+" "+Math.floor(d.offsetY/j)),console.log(w),!w){var e=Math.floor(d.offsetX/j),f=Math.floor(d.offsetY/j);0===d.button?(b[f][e]=a[f][e],a[f][e]=!a[f][e],B()):2===d.button&&(c[f][e]=!c[f][e],a[f][e]=!1,b[f][e]=!1,c[f][e]?A(f,e,q):A(f,e,p))}return!1}),$(window).resize(function(a){F()})};window.lifeGame=G}();